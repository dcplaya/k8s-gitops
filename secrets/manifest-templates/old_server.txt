---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: external-old-plex
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    ingress.kubernetes.io/upstream-vhost: "plex.$DOMAIN"
spec:
  rules:
  - host: plex.old.$DOMAIN
  - host: plex.$DOMAIN
    http:
      paths:
      - backend:
          serviceName: external-old-plex
          servicePort: 443
  tls:
  - hosts:
    - plex.old.$DOMAIN
    - plex.$DOMAIN
---
apiVersion: v1
kind: Service
metadata:
  name: external-old-plex
spec:
  ports:
  - name: https
    port: 443
    targetPort: 32400
  type: ExternalName
  externalName: 10.10.1.60
---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: external-old-plexscan
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
    ingress.kubernetes.io/upstream-vhost: "plexscan.$DOMAIN"
spec:
  rules:
  - host: plexscan.old.$DOMAIN
  - host: plexscan.$DOMAIN
    http:
      paths:
      - backend:
          serviceName: external-old-plexscan
          servicePort: 3468
  tls:
  - hosts:
    - plexscan.old.$DOMAIN
    - plexscan.$DOMAIN
---
apiVersion: v1
kind: Service
metadata:
  name: external-old-plex
spec:
  ports:
  - name: https
    port: 443
    targetPort: 3468
  type: ExternalName
  externalName: 10.10.1.60
---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: external-old-portainer
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    ingress.kubernetes.io/upstream-vhost: "portainer.$DOMAIN"
spec:
  rules:
  - host: portainer.$DOMAIN
    http:
      paths:
      - backend:
          serviceName: external-old-portainer
          servicePort: 443
  tls:
  - hosts:
    - portainer.$DOMAIN
---
apiVersion: v1
kind: Service
metadata:
  name: external-old-portainer
spec:
  ports:
  - name: https
    port: 443
    targetPort: 9000
  type: ExternalName
  externalName: 10.10.1.60
